package algorithm;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.Comparator;
import java.util.LinkedList;
import java.util.PriorityQueue;
import java.util.Queue;

public class Main_16236 {
	static int n;	//n크기 공간에
	static int m;	//m마리 물고기 1마리 아기상어
	static int arr[][];
	static ArrayList<Fish> fish;
	static boolean visited[][];
	static int path = 0;
	/*
	 * 아기 상어 크기는 2
	 * 1초에 상하좌우로 한칸씩 이동가능
	 * 자기보다 크기가 작은 물고기만 먹을 수 있고 같으면 이동은 가능
	 * 
	 * 이동방식
	 * 1. 먹을 물고기가 없으면 엄마상어에 도움 요청
	 * 2. 1마리면 그 물고기를 먹으러 출발
	 * 3. 1마리보다 많으면 가장 가까운 물고기를 먹으러 감
	 * 4. 크기 수 만큼 물고기를 먹으면 크기 1 증가
	 */
	public static void main(String[] args) throws NumberFormatException, IOException {
		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
		n = Integer.parseInt(br.readLine());
		arr = new int[n][n];
		fish = new ArrayList<Fish>();
		visited = new boolean[n][n];
		int x = 0;
		int y = 0;
		
		for (int i = 0; i < n; i++) {
			String str[] = br.readLine().split(" ");
			for (int j = 0; j < n; j++) {
				arr[i][j] = Integer.parseInt(str[j]);
				if(arr[i][j] == 9) {
					x = j;
					y = i;
				}else if(arr[i][j] != 0 ) {
					fish.add(new Fish(j, i, arr[i][j]));
				}
					
			}
		}
		
		fish.sort(new Comparator<Fish>() {
			@Override
			public int compare(Fish o1, Fish o2) {
				return o1.getSize() - o2.getSize();
			}		
		});
		/*for (int i = 0; i < fish.size(); i++) {
			System.out.println("x: "+fish.get(i).getX() + " y: "+ fish.get(i).getY() + " size: "+ fish.get(i).getSize());
		}*/
		System.out.println();
		System.out.println();
		
		bfs(x, y);
		
		System.out.println();
		System.out.println(path);
		
		/*for (int i = 0; i < arr.length; i++) {
			for (int j = 0; j < arr.length; j++) {
				System.out.print(arr[i][j]+" ");
			}
			System.out.println();
		}*/
	}
	private static void bfs(int x, int y) {
		int dx[] = {0, 0, 1, -1};
		int dy[] = {1, -1, 0, 0};
		
		Shark s = new Shark(x, y, 2);
		Queue<Shark> q = new LinkedList<>();
		ArrayList<Fish> fishList = new ArrayList<>();
		boolean isFish = false;
		int sizeCnt = 0;
		
		q.add(s);
		visited[y][x] = true;
		
		while(!q.isEmpty()) {
			
			Shark tempShark = q.poll();
			int sharkX = tempShark.getX();
			int sharkY = tempShark.getY();
			int sharkSize = tempShark.getSize();
			
			fishList.clear();
			
			for (int i = 0; i < 4; i++) {
				int nextX = x + dx[i];
				int nextY = y + dy[i];
				if(nextX >= 0 && nextX < n && nextY >= 0 && nextY < n 
						&& !visited[nextY][nextX] && arr[nextY][nextX] < sharkSize) {
					//이동 할 수 있는 범위 측정
					if(arr[nextY][nextX] > 0) {
						//먹을 수 있는 물고기란 소리
						System.out.println("??");
						fishList.add(new Fish(nextX, nextY, arr[nextY][nextX]));
					}
					q.add(new Shark(nextX, nextY, sharkSize));
				}
			}
			
			isFish = false;
			
			if (fishList.size() > 0) {
				isFish = true;
				int minDistIdx = dist(sharkX, sharkY, fishList);
				Fish fish = fishList.get(minDistIdx);
				++sizeCnt;
				if(sharkSize == sizeCnt) {
					++sharkSize;
					sizeCnt = 0;
				}
				q.clear();
				q.add(new Shark(fish.getX(), fish.getY(), sharkSize));
			}
		}
	
	}
	private static int dist(int sharkX, int sharkY, ArrayList<Fish> fishList) {		
		int minDistIdx = 0;
		int minDist =  Math.abs(sharkX - fishList.get(0).getX()) + Math.abs(sharkY - fishList.get(0).getY());
		
		for (int i = 0; i < fishList.size(); i++) {
			int dist = Math.abs(sharkX - fishList.get(0).getX()) + Math.abs(sharkY - fishList.get(0).getY());
			if(minDist < dist) { 
				minDist = dist;
				minDistIdx = i;
			}else if(minDist == dist) {
				//거리가 같은데
				if(fishList.get(i).getY() < fishList.get(minDistIdx).getY()) {
					//지금께 y축이 더 높다?
					minDistIdx = i;
				}else if(fishList.get(i).getY() == fishList.get(minDistIdx).getY() && fishList.get(i).getX() < fishList.get(minDistIdx).getX()) {
					//y축 거리가 같은데 x축이 더 왼쪽에 가깝다?
					minDistIdx = i;
				}
			}
		}
		path += minDist;
		return minDistIdx;
	}
		
}

class Shark {
	
	int x;
	int y;
	static int size;
	
	public Shark(int x, int y, int size) {
		super();
		this.x = x;
		this.y = y;
		this.size = size;
	}

	public int getX() {
		return x;
	}

	public void setX(int x) {
		this.x = x;
	}

	public int getY() {
		return y;
	}

	public void setY(int y) {
		this.y = y;
	}

	public int getSize() {
		return size;
	}

	public void setSize(int size) {
		this.size = size;
	}
}

class Fish {
	
	int x;
	int y;
	int size;
	
	public Fish(int x, int y, int size) {
		super();
		this.x = x;
		this.y = y;
		this.size = size;
	}

	public int getX() {
		return x;
	}

	public void setX(int x) {
		this.x = x;
	}

	public int getY() {
		return y;
	}

	public void setY(int y) {
		this.y = y;
	}

	public int getSize() {
		return size;
	}

	public void setSize(int size) {
		this.size = size;
	}
	
}